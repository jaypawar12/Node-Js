<%- include('../header') %>

    <div class="main-content position-relative max-height-vh-100 h-100">
        <div class="container-fluid px-2 px-md-4">

            <!-- Header Banner -->
            <div class="page-header min-height-300 border-radius-xl mt-4"
                style="background-image: url('https://images.unsplash.com/photo-1504674900247-0877df9cc836?auto=format&fit=crop&w=1920&q=80'); background-size: cover;">
                <span class="mask bg-gradient-dark opacity-6"></span>
            </div>

            <!-- Add Product Card -->
            <div class="card shadow-lg border-0 mx-4 mt-n6">
                <div class="card-body px-4 py-5">
                    <div class="row justify-content-center">
                        <div class="col-md-10 col-lg-8">

                            <h4 class="text-center text-dark mb-4 fw-bold">
                                <i class="fas fa-box-open me-2 text-dark"></i>Add New Product
                            </h4>

                            <form action="/product/insertProduct" method="POST" enctype="multipart/form-data">

                                <!-- Product Name -->
                                <div class="form-group mb-4">
                                    <label class="form-label fw-semibold"><i
                                            class="fas fa-tag me-2 text-dark"></i>Product Name</label>
                                    <input type="text" name="product_name"
                                        class="form-control p-2 shadow-sm custom-bg border-0"
                                        placeholder="Enter product name" required>
                                </div>

                                <!-- Description -->
                                <div class="form-group mb-4">
                                    <label class="form-label fw-semibold"><i
                                            class="fas fa-info-circle me-2 text-dark"></i>Description</label>
                                    <textarea name="product_description" rows="3"
                                        class="form-control p-2 shadow-sm custom-bg border-0"
                                        placeholder="Enter product description" required></textarea>
                                </div>

                                <!-- Price -->
                                <div class="form-group mb-4">
                                    <label class="form-label fw-semibold"><i
                                            class="fas fa-rupee-sign me-2 text-dark"></i>Price</label>
                                    <input type="number" name="product_price"
                                        class="form-control p-2 shadow-sm custom-bg border-0"
                                        placeholder="Enter product price" required>
                                </div>

                                <!-- Discount -->
                                <div class="form-group mb-4">
                                    <label class="form-label fw-semibold"><i
                                            class="fas fa-percent me-2 text-dark"></i>Discount (%)</label>
                                    <input type="number" name="product_discount"
                                        class="form-control p-2 shadow-sm custom-bg border-0"
                                        placeholder="Enter discount percentage" value="0" required>
                                </div>

                                <!-- Final Price -->
                                <div class="form-group mb-4">
                                    <label class="form-label fw-semibold"><i
                                            class="fas fa-check-circle me-2 text-dark"></i>Final Price</label>
                                    <input type="number" name="product_final_price"
                                        class="form-control p-2 shadow-sm custom-bg border-0"
                                        placeholder="Auto-calculated" readonly required>
                                </div>

                                <!-- Category -->
                                <div class="form-group mb-4">
                                    <label class="form-label fw-semibold"><i
                                            class="fas fa-layer-group me-2 text-dark"></i>Category</label>
                                    <select name="category_id" class="form-select p-2 shadow-sm custom-bg border-0"
                                        required>
                                        <option value="" hidden>-- Select Category --</option>
                                        <% categories.forEach(cat=> { %>
                                            <option value="<%= cat._id %>">
                                                <%= cat.category_name %>
                                            </option>
                                            <% }) %>
                                    </select>
                                </div>

                                <!-- SubCategory -->
                                <div class="form-group mb-4">
                                    <label class="form-label fw-semibold"><i
                                            class="fas fa-sitemap me-2 text-dark"></i>SubCategory</label>
                                    <select name="subCategory_id" class="form-select p-2 shadow-sm custom-bg border-0"
                                        required>
                                        <option value="" hidden>-- Select SubCategory --</option>
                                        <% subCategories.forEach(sub=> { %>
                                            <option value="<%= sub._id %>">
                                                <%= sub.subCategory_name %>
                                            </option>
                                            <% }) %>
                                    </select>
                                </div>

                                <!-- Extra Category -->
                                <div class="form-group mb-4">
                                    <label class="form-label fw-semibold"><i
                                            class="fas fa-plus-square me-2 text-dark"></i>Extra Category</label>
                                    <select name="extraCategory_id" class="form-select p-2 shadow-sm custom-bg border-0"
                                        required>
                                        <option value="" hidden>-- Select Extra Category --</option>
                                        <% extraCategories.forEach(extra=> { %>
                                            <option value="<%= extra._id %>">
                                                <%= extra.extraCategory_name %>
                                            </option>
                                            <% }) %>
                                    </select>
                                </div>

                                <!-- Status -->
                                <div class="form-group mb-4">
                                    <label class="form-label fw-semibold"><i
                                            class="fas fa-toggle-on me-2 text-dark"></i>Status</label>
                                    <select name="product_status" class="form-select p-2 shadow-sm custom-bg border-0"
                                        required>
                                        <option value="Active">Active</option>
                                        <option value="Inactive">Inactive</option>
                                    </select>
                                </div>

                                <!-- Image Upload -->
                                <div class="form-group mb-4">
                                    <label class="form-label fw-semibold"><i
                                            class="fas fa-image me-2 text-dark"></i>Product Image</label>
                                    <input type="file" name="product_image"
                                        class="form-control p-2 shadow-sm custom-bg border-0" required>
                                </div>

                                <!-- Submit Button -->
                                <div class="text-center mt-4">
                                    <button type="submit" class="btn btn-lg bg-gradient-dark text-white px-5 shadow">
                                        <i class="fas fa-plus-circle me-2"></i>Add Product
                                    </button>
                                </div>

                            </form>

                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <footer class="footer py-4 mt-5">
                <div class="container-fluid">
                    <div class="row align-items-center justify-content-lg-between">
                        <div class="col-lg-6 mb-lg-0 mb-4 text-center text-muted text-sm text-lg-start">
                            ©
                            <script>document.write(new Date().getFullYear())</script>, made with ❤️ by Jay Pawar
                        </div>
                        <div class="col-lg-6">
                            <ul class="nav nav-footer justify-content-center justify-content-lg-end">
                                <li class="nav-item"><a href="#" class="nav-link text-muted">Creative Tim</a></li>
                                <li class="nav-item"><a href="#" class="nav-link text-muted">About Us</a></li>
                                <li class="nav-item"><a href="#" class="nav-link text-muted">Blog</a></li>
                                <li class="nav-item"><a href="#" class="nav-link pe-0 text-muted">License</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </footer>

        </div>
    </div>

    <%- include('../footer') %>

        <!-- Custom Style -->
        <style>
            .custom-bg {
                background-color: #e3f2fd !important;
            }

            .form-label {
                font-weight: 600;
            }

            .form-control,
            .form-select {
                height: 45px;
            }

            .form-group i {
                min-width: 20px;
            }

            textarea.form-control {
                height: auto;
                resize: vertical;
            }
        </style>

        
        <script>
            const priceInput = document.querySelector('[name="product_price"]');
            const discountInput = document.querySelector('[name="product_discount"]');
            const finalPriceInput = document.querySelector('[name="product_final_price"]');

            function updateFinalPrice() {
                const price = parseFloat(priceInput.value) || 0;
                const discount = parseFloat(discountInput.value) || 0;
                const final = price - (price * discount / 100);
                finalPriceInput.value = final.toFixed(2);
            }

            priceInput.addEventListener('input', updateFinalPrice);
            discountInput.addEventListener('input', updateFinalPrice);
        </script>